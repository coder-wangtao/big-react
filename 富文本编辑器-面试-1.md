## 需求问题

**为什么做这个项目？**，是面试官经常喜欢问的一个问题，其实，面试官大多数时候**并不是在质疑你“做了没意义”**，而是想看你能不能**从业务视角、技术视角**去解释为什么公司会去做一个类似产品，价值是什么？但是**很多时候我们自己给自己下套**，总觉得是面试官在质疑我，所以我们首先要从心理层面摆脱这种思维，而是以业务，技术角度出发谈需求，这样反而能显示出自己的自信。

下面的几点，可以**根据自己工作经历**，选择合适的进行回答：

> **1.技术与数据安全角度（适合偏 ToB 企业）**
>
> “像飞书文档虽然功能齐全，但它是一个 SaaS 产品，数据完全存在飞书的服务器上。对于一些对**数据安全、合规**有要求的公司，比如金融、医疗、政府机构，他们往往不能把内部知识库放在第三方平台。这时候企业需要一套**自研或私有化部署的协同编辑系统**，既能满足业务需求，又能保障数据的掌控权。”
>
> **2.定制化与扩展性角度（适合偏 创业公司 / 产品公司）**
>
> “飞书文档功能强大，但它的功能和交互是固定的，没办法完全贴合我们自身业务。比如我们想在文档里集成**业务数据表、流程审批、代码片段协同、课程内容管理**等，飞书就无法深度定制。自研的优势是能做到**插件化架构**，根据业务需要扩展功能，而不仅仅是一个‘通用文档’。”
>
> **3.成本与战略角度（适合 大型公司）**
>
> “飞书本身是一个生态产品，背后是字节跳动的战略布局。如果我们公司在做知识库、文档协同、办公平台方向，过度依赖飞书等第三方就会受制于人。一旦它的产品策略调整、接口关闭，或者收费策略变化，我们会陷入被动。所以**自建编辑器是从长远战略上降低依赖和成本**的做法。”

### 核心业务需求

- 提供完善的富文本编辑功能，并能实现类似于飞书文档`slash(/斜杆提示)`功能
- 实现协同编辑，可以多用户共享协作
- 实现`mention(@文档引用)`，并且实现文档引用关系可视化图谱
- 可扩展的插件化设计系统，支持自定义功能

### 核心技术需求

- 基于 **tiptap** 实现富文本编辑器，提供基础的富文本编辑功能，支持块级文档结构与插件化扩展
- 使用 **Yjs** 实现多人实时协同，解决冲突合并与操作同步问题
- 结合 **IndexedDB** 实现离线编辑与自动恢复，提升用户体验
- 利用 **y-postgresql** 持久化文档，支持断线重连与历史版本保存
- 使用 **react-flow** 实现文档关系图谱，并使用 **d3-force** 优化可视化效果

## 建议简历写法

![image-20250826114439574](./assets/image-20250826114439574.png)

## 相关问题

### 回答思路结构

1. **不要说是某个 API 不会用**（那显得太初级了）
2. 要从 **复杂度、架构权衡、性能与扩展性** 的角度回答
3. 最好能体现：
   - 我识别出了问题的本质
   - 我探索了不同方案
   - 我权衡利弊并给出了解决方案

### 1、市面上已经有飞书文档、Notion 这样的产品了，你们为什么还要自己做一个？

> 这个是从 **业务场景差异化** 出发的。像飞书、Notion 虽然功能完整，但它们是通用型的 SaaS 产品，并不一定能满足企业的 **个性化文档协同需求**。所以在设计时主要考虑了三个方面：
>
> 1. **可控性与数据安全** —— 企业往往要求将文档系统部署在内网或私有云，而第三方 SaaS 难以完全满足合规性要求。
> 2. **扩展性** —— 我们的架构采用插件化内核，可以根据不同业务快速扩展功能（比如定制审批流、行业专属知识图谱）。
> 3. **深度集成** —— 与企业现有系统（CRM、项目管理平台等）深度打通，而不是作为孤立工具。
>
> 所以，这个项目的价值不在于“复制飞书”，而在于 **为企业提供一个可裁剪、可扩展、可控的协同文档基座**。

### 2、你的项目是 Monorepo，你为什么要用这种架构？

> 选择 Monorepo 的原因是希望 **前后端与编辑器内核形成统一的演进节奏**，并且便于做跨层面的功能联动。
>
> - **packages 层** 我拆成 core、react、shadcn 三个包，分别负责文档内核逻辑、框架绑定和 UI 层，这样既能独立演化，又能保证解耦。
> - **apps 层** 用于承载实际的前后端应用，避免业务代码和内核逻辑混杂。
>
> 这种架构带来的最大价值是：**我们可以像构建“平台”一样维护文档系统，而不是做一个“孤立项目”。**
>
> 而且，核心逻辑完全与 UI 分离，React 层只做框架适配。如果未来需要支持 Vue 或移动端，只需重写 UI 层和框架绑定层即可，core 层保持不变。
> 这种思路保证了系统 **跨平台复用性**，同时避免重复造轮子。

### 3、多人协同编辑里，你为什么选择 Yjs 而不是其他方案？

> 协同编辑的本质问题是 **冲突解决和最终一致性**。选择 Yjs 的原因主要是：
>
> 1. 它基于 CRDT，能天然解决并发冲突，无需中心化服务器做仲裁。
> 2. 插件生态成熟（比如 WebSocketProvider、IndexedDBPersistence、y-postgresql），能快速实现在线协作、离线编辑、持久化存储。
> 3. 与前端编辑器（Tiptap）有良好集成，可以避免在业务层自己造轮子。
>
> 同时在架构上做了扩展：通过 **y-postgresql** 存储历史快照和增量更新，实现了 **可追溯性和容灾恢复**，这对企业级应用非常关键。

### 4、你提到文档引用关系可视化图谱，为什么要做这个？

> 传统文档系统只是“存储与编辑”，而企业真正的痛点是 **知识孤岛**。我通过 **mention 功能 + 图谱可视化**，把文档关系显性化：
>
> - 在知识管理层面，可以帮助快速发现上下游依赖关系。
> - 在团队协作层面，可以直观呈现知识网络，而不是依赖搜索。
>
> 在技术上用 **react-flow + d3-force** 来渲染，并把关系数据直接映射自协同文档存储层，这样保证 **关系可视化与实际数据完全一致**。

### 5、你说支持插件化扩展，可以具体讲讲你是怎么设计的吗？

> 由于富文本编辑是基于 Tiptap 的二次开发，Tiptap 本身就是基于插件化开发的典范，同样，在自己的 monorepo 工程的 core 包中定义了 **extensions 处理**。这样每个功能，比如 Slash 命令、Mention 引用，都是以插件的形式加载进来。
>
> 插件化设计的好处是：
>
> - 新功能可以独立开发，不需要修改核心代码；
> - 不同项目可以选择性加载插件，保证灵活性；
> - 后续要支持评论、表格、任务清单等功能，只需要实现插件接口即可。

### 6.在这个项目中，你遇到的最大挑战或者说最大的难点是什么？

> 这个问题，其实可以从几个方面都可以回答，可以挑选你觉得合适回答，比如：
>
> **协同冲突与一致性问题**
>
> > 我认为最大的挑战是**多人协同编辑时的一致性和冲突解决**。
> > 在传统的富文本编辑里，编辑器只需要处理本地的操作流，但在多人协同场景下，必须同时保证**操作的有序性**、**冲突合并的正确性**以及**最终一致性**。
> > 为了解决这个问题，我选用了 **Yjs 的 CRDT 模型**，它能在无中心化的情况下自动合并冲突，但它本身也带来了一些新的挑战：比如**数据体量较大时内存占用与性能下降**。
> > 我的解决方案是：
> >
> > 1. 在前端结合 **IndexedDB** 做本地缓存，避免每次全量加载；
> > 2. 在后端基于 **y-postgresql** 做持久化存储，并通过快照+增量更新的机制，减少大文档的加载成本；
> > 3. 另外，在文档关系图谱上，我对渲染做了**增量更新**，避免因为节点过多而导致界面卡顿。
> >    这一系列方案保证了用户在弱网或多人同时操作时，依然能获得接近飞书、Notion 那样的流畅体验。
>
> **插件化与可扩展性设计**
>
> > 对我来说，最有挑战性的部分是 **如何设计一个可扩展的插件化体系**。
> > 市面上的编辑器大多是功能固化的，要么在自定义能力上限制很大，要么扩展成本很高。而我的目标是做一个类似于 **Notion 的 slash 命令体系**，用户可以通过插件无缝扩展功能。
> > 在架构上，我把系统拆分成三个层次：
> >
> > - **core 包**：只负责核心文档数据结构和命令调度，不依赖 UI；
> > - **react 包**：负责和 React 生态对接，把 command 映射为可组合的组件；
> > - **shadcn 包**：提供 UI 层实现，比如 slash 菜单和弹窗。
> >
> > 这种解耦设计使得未来如果要迁移到 Vue、Svelte 甚至移动端，也只需要替换 UI 层。
> > 最大的难点在于**命令分发和依赖管理**，我借鉴了 tiptap 的 Extension 体系，并在其基础上做了抽象，保证插件既能独立扩展，又能和协同逻辑耦合。
